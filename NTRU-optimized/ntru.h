#include <stdint.h>
#define NTRU_N_112 401  // polynomial size, N
#define NTRU_Q_112 2048 // modulus
#define NTRU_DF_112 101
#define NTRU_DG_112 131
#define NTRU_P_112 3 //The number of bits to the largest modulus value NTRU-112 is used
#define NTRU_S112_Q_BITS    11
#define NTRU_ENCODE_BYTE    48

#pragma PERSISTENT(r112)
int16_t r112[NTRU_N_112] = {
                           -1, 0,  1,  0,  0,  0,  -1, -1, 0,  -1,
                           -1, 0,  0,  0,  0,  1,  1,  1,  0,  -1,
                           0,  0,  -1, 0,  0,  1,  -1, 0,  1,  -1,
                           0,  0,  1,  1,  1,  1,  0,  1,  -1, 0,
                           1,  1,  -1, 0,  -1, 1,  1,  1,  0,  0,
                           -1, 0,  0,  1,  0,  0,  1,  -1, 0,  0,
                           0,  -1, 0,  -1, 1,  0,  0,  0,  -1, -1,
                           1,  -1, 0,  0,  0,  -1, 0,  0,  0,  1,
                           0,  0,  1,  -1, 0,  0,  -1, 0,  -1, 1,
                           1,  -1, -1, 1,  0,  0,  -1, 1,  0,  1,
                           0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
                           0,  0,  1,  1,  0,  0,  0,  0,  0,  -1,
                           -1, 0,  1,  0,  1,  1,  0,  -1, 0,  1,
                           0,  0,  0,  1,  -1, 0,  1,  1,  0,  0,
                           0,  1,  0,  0,  0,  1,  0,  0,  0,  1,
                           -1, -1, 0,  0,  1,  -1, 0,  0,  -1, 1,
                           0,  1,  0,  0,  -1, 0,  0,  -1, -1, 1,
                           0,  0,  -1, -1, 1,  1,  0,  0,  -1, -1,
                           0,  0,  1,  0,  -1, 1,  0,  1,  0,  -1,
                           0,  1,  0,  -1, 0,  -1, 0,  -1, -1, 0,
                           0,  1,  -1, 0,  0,  -1, -1, 0,  0,  0,
                           0,  1,  -1, -1, 1,  0,  1,  0,  -1, 0,
                           0,  -1, 0,  1,  0,  -1, 0,  0,  -1, 1,
                           0,  -1, 0,  0,  0,  -1, 1,  0,  -1, 0,
                           -1, -1, 1,  -1, 0,  0,  0,  0,  1,  -1,
                           0,  0,  0,  0,  -1, 0,  -1, -1, 0,  -1,
                           0,  0,  0,  1,  0,  0,  0,  1,  0,  0,
                           -1, -1, 1,  -1, -1, 1,  0,  0,  0,  0,
                           0,  1,  1,  -1, 1,  -1, -1, -1, 1,  1,
                           0,  -1, 1,  0,  0,  0,  1,  -1, 0,  0,
                           -1, 0,  -1, -1, 0,  0,  -1, 1,  0,  0,
                           -1, 0,  -1, 1,  0,  0,  -1, 0,  1,  1,
                           0,  1,  -1, 1,  0,  1,  -1, -1, -1, 0,
                           0,  1,  0,  0,  1,  0,  0,  0,  -1, 1,
                           0,  -1, 1,  -1, 0,  1,  -1, 1,  1,  0,
                           0,  1,  1,  0,  1,  1,  0,  0,  0,  -1,
                           1,  -1, 0,  1,  0,  0,  0,  0,  1,  0,
                           0,  1,  1,  0,  1,  -1, 1,  -1, 1,  1,
                           1,  0,  0,  -1, 0,  0,  1,  0,  -1, 1,
                           0,  0,  -1, 0,  -1, -1, 0,  0,  1,  0,
                           1
};

#pragma PERSISTENT(h112)
int16_t h112[NTRU_N_112] = {
                            378,    3812,   330,    3400,   647,    837,    3997,   3523,   3266,   417,
                            3570,   3711,   3976,   3136,   301,    87, 429,    314,    3731,   230,
                            3910,   3350,   3402,   797,    3957,   3203,   3897,   460,    810,    3573,
                            441,    961,    3851,   3722,   3294,   4024,   3534,   3700,   339,    3089,
                            96, 4079,   8,  515,    390,    3789,   932,    76, 349,    556,
                            277,    3188,   443,    108,    3477,   669,    347,    694,    3135,   3366,
                            3405,   3724,   3666,   96, 3735,   660,    3720,   3699,   1005,   4049,
                            3598,   967,    3948,   287,    476,    89, 3556,   3148,   809,    773,
                            912,    505,    672,    271,    693,    3491,   3464,   3823,   359,    4014,
                            3717,   198,    334,    3768,   563,    693,    81, 3581,   374,    3176,
                            453,    764,    118,    3588,   3962,   3976,   52, 992,    395,    3892,
                            13, 3927,   3927,   225,    3961,   606,    3303,   481,    3281,   4,
                            873,    3148,   856,    3809,   3096,   620,    40, 3332,   558,    4027,
                            3178,   3497,   647,    4010,   3302,   961,    963,    4029,   3598,   261,
                            356,    3579,   706,    270,    180,    114,    3606,   3181,   3729,   3768,
                            597,    652,    399,    243,    3205,   161,    472,    1023,   211,    284,
                            954,    293,    66, 306,    322,    649,    3535,   3819,   257,    4082,
                            452,    3223,   949,    3864,   3917,   401,    4082,   3867,   247,    3235,
                            3820,   923,    527,    3676,   472,    393,    3586,   193,    3690,   3354,
                            1012,   3665,   762,    343,    954,    3314,   3677,   3366,   204,    462,
                            3810,   402,    3504,   565,    3377,   4073,   723,    12, 175,    3327,
                            504,    3897,   958,    863,    3692,   690,    3391,   3769,   48, 3178,
                            3187,   3286,   3799,   1,  3863,   3096,   3949,   991,    3732,   3930,
                            3986,   3223,   881,    3486,   3848,   930,    966,    264,    3098,   4053,
                            619,    105,    3323,   505,    66, 123,    3582,   96, 232,    3151,
                            3503,   938,    91, 932,    3520,   442,    3186,   48, 592,    432,
                            3715,   3845,   534,    3701,   175,    77, 3721,   3829,   378,    3874,
                            78, 3883,   3982,   607,    846,    3549,   3227,   3837,   706,    3897,
                            839,    3098,   838,    3213,   3179,   4055,   3566,   3857,   3079,   3075,
                            284,    46, 876,    3133,   802,    3787,   3650,   3384,   992,    4,
                            3636,   847,    290,    107,    3494,   3915,   3762,   3314,   382,    3193,
                            3765,   3129,   3841,   816,    662,    503,    980,    3636,   955,    980,
                            514,    3883,   108,    3898,   497,    98, 3272,   770,    3075,   4026,
                            471,    4072,   402,    3075,   3848,   4082,   3405,   971,    3171,   479,
                            3912,   209,    3137,   3474,   3589,   585,    3640,   3163,   391,    994,
                            405,    12, 4075,   937,    4065,   4094,   465,    3112,   3990,   772,
                            3816,   3908,   646,    109,    3385,   108,    121,    784,    573,    840,
                            474,    48, 3554,   902,    452,    411,    484,    3651,   4048,   3151,
                            990,    666,    973,    3367,   3306,   3770,   444,    207,    622,    3874,
                            229,    3131,   3930,   3759,   3089,   928,    878,    183,    4056,   552,
                            496
};
#pragma PERSISTENT(test_m112)

int8_t test_m112[NTRU_N_112] = {
                                -1, -1, 1,  1,  1,  -1, -1, -1,
                                -1, -1, -1, -1, -1, -1, -1, -1,
                                -1, -1, -1, 1,  1,  -1, 1,  1,
                                1,  1,  1,  1,  1,  1,  -1, -1,
                                1,  1,  1,  1,  1,  1,  -1, -1,
                                1,  -1, 1,  -1, -1, 1,  1,  1,
                                1,  1,  1,  1,  1,  1,  -1, 1,
                                1,  -1, -1, 1,  1,  -1, 1,  1,
                                1,  -1, -1, 1,  -1, -1, -1, 1,
                                1,  1,  1,  1,  1,  -1, 1,  -1,
                                1,  1,  1,  1,  1,  1,  -1, -1,
                                -1, 1,  -1, 1,  -1, -1, 1,  1,
                                1,  -1, 1,  1,  1,  -1, 1,  -1,
                                1,  1,  -1, 1,  -1, -1, -1, -1,
                                -1, 1,  -1, 1,  -1, 1,  1,  -1,
                                1,  -1, -1, 1,  -1, -1, 1,  1,
                                1,  -1, -1, 1,  1,  -1, -1, 1,
                                1,  -1, -1, -1, -1, 1,  1,  -1,
                                -1, -1, 1,  1,  -1, -1, -1, 1,
                                1,  -1, -1, -1, 1,  1,  -1, -1,
                                1,  1,  1,  -1, 1,  -1, -1, -1,
                                -1, 1,  -1, -1, 1,  1,  1,  -1,
                                1,  1,  -1, -1, 1,  -1, 1,  1,
                                1,  -1, -1, 1,  -1, 1,  -1, 1,
                                1,  -1, 1,  1,  1,  -1, 1,  1,
                                1,  1,  -1, -1, 1,  -1, -1, -1,
                                1,  -1, 1,  -1, 1,  -1, 1,  1,
                                1,  -1, -1, -1, 1,  1,  1,  1,
                                -1, -1, 1,  1,  1,  -1, 1,  1,
                                -1, 1,  -1, 1,  -1, 1,  1,  1,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0,  0,  0,  0,  0,  0,  0,  0,
                                0
};
#pragma PERSISTENT(f112)
int16_t f112[NTRU_N_112] = {1,  0,  0,  0,  3,  3,  0,  3,
                            0,  2045,   2045,   0,  2045,   0,  0,  3,
                            2045,   0,  0,  2045,   0,  2045,   0,  0,
                            0,  0,  0,  3,  2045,   0,  0,  0,
                            3,  2045,   0,  2045,   2045,   0,  0,  2045,
                            0,  2045,   0,  3,  3,  3,  0,  2045,
                            3,  0,  0,  2045,   0,  2045,   0,  2045,
                            0,  0,  0,  3,  3,  2045,   3,  0,
                            3,  0,  2045,   2045,   0,  3,  0,  0,
                            0,  3,  0,  0,  3,  3,  3,  3,
                            0,  0,  3,  3,  2045,   0,  0,  3,
                            0,  0,  3,  2045,   0,  2045,   3,  0,
                            2045,   0,  0,  2045,   3,  0,  0,  0,
                            0,  2045,   3,  0,  0,  0,  3,  0,
                            2045,   0,  0,  3,  2045,   2045,   3,  3,
                            0,  0,  0,  0,  3,  0,  2045,   2045,
                            0,  3,  0,  0,  3,  0,  2045,   2045,
                            2045,   0,  0,  0,  2045,   0,  0,  3,
                            3,  2045,   0,  0,  2045,   3,  2045,   2045,
                            3,  3,  2045,   0,  0,  0,  0,  3,
                            0,  0,  0,  0,  0,  0,  0,  0,
                            0,  0,  2045,   0,  3,  2045,   0,  0,
                            2045,   3,  2045,   0,  3,  2045,   0,  0,
                            0,  0,  3,  3,  0,  2045,   2045,   0,
                            0,  3,  3,  2045,   2045,   3,  0,  3,
                            0,  0,  3,  0,  0,  0,  2045,   0,
                            0,  3,  0,  2045,   3,  0,  2045,   3,
                            2045,   0,  0,  3,  3,  2045,   0,  3,
                            2045,   2045,   0,  0,  2045,   0,  0,  0,
                            0,  2045,   0,  0,  0,  0,  2045,   0,
                            2045,   3,  0,  3,  0,  3,  3,  0,
                            2045,   2045,   3,  0,  0,  3,  0,  2045,
                            0,  2045,   3,  0,  0,  0,  0,  3,
                            3,  0,  2045,   0,  0,  0,  0,  0,
                            0,  0,  2045,   2045,   0,  3,  0,  3,
                            3,  0,  2045,   3,  3,  0,  0,  0,
                            2045,   0,  2045,   0,  0,  3,  0,  3,
                            2045,   0,  2045,   2045,   0,  0,  2045,   3,
                            3,  2045,   3,  3,  3,  2045,   2045,   3,
                            3,  0,  3,  0,  0,  2045,   3,  0,
                            3,  0,  0,  0,  0,  2045,   2045,   2045,
                            2045,   3,  0,  2045,   2045,   2045,   3,  0,
                            2045,   3,  3,  0,  3,  3,  3,  2045,
                            3,  2045,   0,  0,  0,  2045,   0,  2045,
                            0,  0,  3,  2045,   0,  2045,   0,  0,
                            0,  2045,   0,  3,  0,  0,  3,  0,
                            0,  0,  2045,   3,  0,  2045,   2045,   0,
                            0,  0,  0,  3,  2045,   3,  0,  0,
                            0,  0,  0,  2045,   3,  2045,   2045,   0,
                            3,  0,  0,  2045,   3,  2045,   0,  3,
                            3};

//
//int32_t encrypted[NTRU_N_112] = {
//    818,    -845,   -612,   -414,   66,     -231,   -608,   -649,
//    -886,   -783,   154,    -132,   962,    365,    960,    741,
//    611,    801,    -118,   77,     118,    43,     -429,   -810,
//    338,    912,    532,    -651,   353,    -706,   -213,   -72,
//    -828,   145,    508,    -996,   226,    -771,   504,    445,
//    505,    910,    -390,   -513,   991,    596,    -370,   547,
//    698,    -350,   -861,   -941,   -310,   -474,   988,    -463,
//    -8,     529,    -884,   -52,    -21,    186,    -261,   -347,
//    -985,   0,      -934,   -569,   -834,   -117,   -261,   -502,
//    538,    478,    951,    -27,    390,    -825,   475,    846,
//    -601,   -922,   771,    848,    -916,   -887,   83,     521,
//    -678,   291,    240,    -106,   -241,   -879,   -17,    146,
//    913,    -59,    433,    -95,    -997,   -668,   -798,   840,
//    604,    318,    554,    740,    745,    -574,   -211,   349,
//    -266,   -249,   553,    -410,   -81,    -353,   -311,   -27,
//    -922,   -475,   -683,   973,    1014,   300,    762,    -668,
//    -439,   574,    -547,   -286,   -576,   959,    -396,   307,
//    186,    -311,   -79,    -486,   409,    402,    850,    -464,
//    261,    527,    -501,   669,    901,    -100,   -497,   -335,
//    -747,   221,    -794,   795,    -434,   512,    -754,   534,
//    -377,   514,    -78,    323,    842,    798,    334,    928,
//    -195,   416,    -226,   -653,   261,    238,    682,    -898,
//    -954,   -213,   740,    280,    -822,   -505,   -760,   -490,
//    -439,   912,    -878,   681,    -638,   340,    533,    546,
//    546,    684,    -638,   -276,   813,    30,     58,     781,
//    -226,   932,    270,    517,    -214,   549,    266,    609,
//    -788,   61,     997,    -354,   700,    -705,   -418,   760,
//    228,    -197,   98,     -976,   -687,   586,    306,    656,
//    361,    -122,   -317,   -916,   -826,   -490,   -771,   -425,
//    573,    -482,   -1006,  185,    989,    674,    -392,   -204,
//    811,    736,    629,    1004,   979,    -238,   -699,   -602,
//    16,     -107,   624,    701,    910,    495,    -775,   -537,
//    -212,   -681,   -135,   -890,   -316,   -843,   -379,   1,
//    909,    -653,   133,    -500,   -900,   -164,   -236,   396,
//    160,    -582,   -628,   -586,   805,    -449,   265,    -1014,
//    -149,   -983,   -379,   -665,   478,    927,    -66,    -815,
//    -306,   -616,   951,    477,    54,     661,    -1010,  583,
//    615,    779,    -299,   -439,   -987,   -196,   987,    493,
//    66,     -733,   1012,   859,    -850,   184,    829,    966,
//    -411,   1023,   76,     -315,   1023,   -912,   387,    400,
//    896,    -389,   -579,   -925,   -460,   519,    -222,   -636,
//    -906,   -341,   723,    935,    24,     -805,   637,    41,
//    -873,   710,    648,    -728,   -879,   467,    181,    -583,
//    -74,    899,    -356,   68,     56,     461,    149,    402,
//    -948,   -192,   -671,   -367,   -738,   -833,   230,    -755,
//    917,    -981,   -368,   1005,   -553,   -997,   946,    273,
//    -564,   -371,   -458,   -852,   -655,   -553,   585,    -227,
//    694,    -856,   -49,    836,    426,    509,    -776,   -633,
//    531,    -209,   -784,   46,     177,    -53,    -419,   -647,
//    -433,   -530,   -1017,  778,    336,    -110,   -1022,  -565,
//    910
//};
